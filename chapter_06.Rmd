---
title: "chapter_06"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r}
library("tidyverse")
```

# Давление насыщенного пара

Давление насыщенного пара воды или льда --- это максимальное давление водяного пара, находящегося в равновесии с водой или льдом при данной темпрературе.

Рассмотрим некоторые значения давления при заданной температуре. 

```{r}
# Записываем в tibble-фрейм csv-файл. 
# Т.к. файл был создан в эксле - разделитель точка с запятой 
# Задаём имя переменным, и пропускаем первую строку, потому что она содержит метаданные (названия)
water_pressure <- read_delim("water_pressure.csv",
                             col_names = c("temperature", "pressure"), 
                             delim = ";", 
                             skip = 1)
water_pressure
```

Даже невооруженным взглядом видно, что непосредственный график давления от температуры даст лишь очень быстро растущее давление.

```{r}
ggplot(water_pressure, aes(temperature, pressure)) +
  geom_point()
```

При таком построении не видно что происходит с давлением при малых температурах. Для того чтобы понять что там происходит, можно сделать что-нибудь для спрямления графика. Напрашивается взять логарифм от давления.

```{r}
# добавляем переменную, в которой посчитан десятичный логарифм
water_pressure %>%
  mutate(log_pressure = log10(pressure)) %>%
  ggplot(aes(temperature, log_pressure)) + 
  geom_point() + 
  labs(  x = "Температура, \u00b0С",
         y = "lg давления",
         title = "Давление пара воды и температура", 
         subtitle = "(логарифмический масштаб для давления выраженного в мм рт. ст.)"
         )
```

Уже здесь можно взять остатки по прямой. Но можно поступить лучше --- в физической химии логарифм давления обычно изображают в зависимости от обратной величины абсолютной температуры. Абсолютная температура ищется несложно она равно температуре по Цельсию плюс $273.1^\circ C$. Множитель $1000$ введён для того чтобы убрать мешающие нули.

```{r}
water_pressure %>%
  mutate(log_pressure = log10(pressure),
         devide_temperature = -1000 * (1 / (temperature + 273.1))) %>%
  ggplot(aes(devide_temperature, log_pressure)) + 
  geom_point() + 
  labs(  x = "Отрицательная обратная величина абсолютной температуры",
         y = "lg давления",
         title = "Давление пара воды и температура", 
         subtitle = "(Логарифм давления, обратная величина от абсолютной температуры)"
         )
```


Наконец, получена достаточно хорошая прямая, от которой можно посчитать остатки.
```{r}
water_pressure %>%
  mutate(log_pressure = log10(pressure),
         devide_temperature = -1000 * (1 / (temperature + 273.1)),
         residue = log10(pressure) - 2.25 * (devide_temperature)) %>%
  ggplot(aes(devide_temperature, residue - 8.8)) + 
  geom_point() + 
  geom_line() +
  labs(x = "Отрицательная обратная величина абсолютной температуры",
       y = "Остаток",
       title = "Остатки логарифмов давления пара\nпосле вычитания прямой с аргументом -1/T (для воды)"
       )
```

